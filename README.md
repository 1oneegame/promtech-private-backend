# IntegrityOS Backend

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è backend —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–æ–≤**: –ü–æ–ª–Ω—ã–π CRUD —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏
- **ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º XGBoost, Random Forest –∏ Logistic Regression
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –¥–µ—Ñ–µ–∫—Ç–æ–≤, –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º
- **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å —Ä–æ–ª–µ–≤—ã–º –¥–æ—Å—Ç—É–ø–æ–º
- **CSV –∏–º–ø–æ—Ä—Ç**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV —Ñ–∞–π–ª–æ–≤
- **MongoDB –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
- **RESTful API**: –ê–≤—Ç–æ–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ Swagger/OpenAPI

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
2. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
3. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
4. [API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
5. [–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ](#–º–∞—à–∏–Ω–Ω–æ–µ-–æ–±—É—á–µ–Ω–∏–µ)
6. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏)
7. [Troubleshooting](#troubleshooting)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11+
- MongoDB
- pip –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### Windows PowerShell

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è
.\venv\Scripts\Activate.ps1
```

#### Linux / macOS

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python3 -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è
source venv/bin/activate
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env
notepad .env  # Windows
nano .env     # Linux/Mac
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`:**
```env
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/?retryWrites=true&w=majority
JWT_SECRET_KEY=your_secret_key_here
MONGODB_DATABASE=integrity_os
```

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT –∫–ª—é—á–∞:**
```bash
python -c "import secrets; print(secrets.token_urlsafe(32))"
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
python main.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8000`

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞:
- **API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `http://localhost:8000/docs`
- **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `http://localhost:8000/redoc`
- **Health check:** `http://localhost:8000/health`

---


## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# Database Configuration
MONGODB_URI=mongodb+srv://<username>:<password>@cluster.mongodb.net/integrity_os
MONGODB_DATABASE=integrity_os
MONGODB_COLLECTION=defects

# API Configuration
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=true
API_WORKERS=1

# JWT Authentication
JWT_SECRET_KEY=your-secret-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60

# Logging
LOG_LEVEL=INFO
```

### –ü—Ä–∏–º–µ—Ä .env

```env
# Development Environment
MONGODB_URI=mongodb+srv://<username>:<password>@cluster.mongodb.net/integrity_os
MONGODB_DATABASE=integrity_os
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=true
JWT_SECRET_KEY=dev-secret-key-change-in-production
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
LOG_LEVEL=INFO
```


## –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π API

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### POST /auth/login
–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞.

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "username": "admin",
  "password": "admin"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer",
  "expires_in": 3600,
  "role": "admin"
}
```

#### GET /auth/me
–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

**–¢—Ä–µ–±—É–µ—Ç:** Authorization Bearer —Ç–æ–∫–µ–Ω

**–û—Ç–≤–µ—Ç:**
```json
{
  "username": "admin",
  "role": "admin"
}
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏

#### GET /defects
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤ —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `defect_type` (optional): –¢–∏–ø –¥–µ—Ñ–µ–∫—Ç–∞ (–∫–æ—Ä—Ä–æ–∑–∏—è, —Å–≤–∞—Ä–Ω–æ–π —à–æ–≤, –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π –æ–±—ä–µ–∫—Ç)
- `segment` (optional): –ù–æ–º–µ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞ —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–∞

**–û—Ç–≤–µ—Ç:**
```json
{
  "total": 100,
  "defects": [
    {
      "defect_id": "DEF001",
      "segment_number": 1,
      "measurement_distance_m": 150.5,
      "pipeline_id": "PIPE-001",
      "details": {
        "type": "–∫–æ—Ä—Ä–æ–∑–∏—è",
        "parameters": {
          "depth_percent": 45.5,
          "length_mm": 120.0,
          "width_mm": 50.0
        },
        "location": {
          "latitude": 43.5,
          "longitude": 76.9,
          "altitude": 250.0
        }
      }
    }
  ],
  "filters_applied": {
    "defect_type": null,
    "segment": null
  }
}
```

#### GET /defects/search
–ü–æ–∏—Å–∫ –¥–µ—Ñ–µ–∫—Ç–æ–≤ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `defect_type` (optional)
- `segment` (optional)

#### GET /defects/{defect_id}
–ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–µ—Ñ–µ–∫—Ç –ø–æ ID.

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

#### GET /statistics
–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º –¥–µ—Ñ–µ–∫—Ç–∞–º.

**–û—Ç–≤–µ—Ç:**
```json
{
  "total_defects": 1500,
  "defects_by_type": {
    "–∫–æ—Ä—Ä–æ–∑–∏—è": 800,
    "—Å–≤–∞—Ä–Ω–æ–π —à–æ–≤": 500,
    "–º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π –æ–±—ä–µ–∫—Ç": 200
  },
  "defects_by_severity": {
    "–∫—Ä–∏—Ç–∏—á–Ω—ã–π": 150,
    "–≤—ã—Å–æ–∫–∏–π": 300,
    "—Å—Ä–µ–¥–Ω–∏–π": 600,
    "–Ω–∏–∑–∫–∏–π": 450
  },
  "total_segments": 45,
  "average_depth_percent": 35.5
}
```

### –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

#### POST /ml/predict
–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –¥–µ—Ñ–µ–∫—Ç–∞ —Å –ø–æ–º–æ—â—å—é ML –º–æ–¥–µ–ª–∏.

**–ó–∞–ø—Ä–æ—Å (–≤–ª–æ–∂–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):**
```json
{
  "defect_id": "DEF001",
  "segment_number": 1,
  "measurement_distance_m": 150.5,
  "pipeline_id": "PIPE-001",
  "details": {
    "type": "–∫–æ—Ä—Ä–æ–∑–∏—è",
    "parameters": {
      "depth_percent": 45.5,
      "length_mm": 120.0,
      "width_mm": 50.0,
      "depth_mm": 5.5,
      "wall_thickness_mm": 12.0
    },
    "location": {
      "latitude": 43.5,
      "longitude": 76.9,
      "altitude": 250.0
    },
    "surface_location": "–í–ù–®",
    "distance_to_weld_m": 2.5,
    "erf_b31g_code": 0.85
  }
}
```

**–ó–∞–ø—Ä–æ—Å (–ø–ª–æ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):**
```json
{
  "depth_percent": 45.5,
  "depth_mm": 5.5,
  "length_mm": 120.0,
  "width_mm": 50.0,
  "wall_thickness_mm": 12.0,
  "distance_to_weld_m": 2.5,
  "erf_b31g": 0.85,
  "altitude_m": 250.0,
  "latitude": 43.5,
  "longitude": 76.9,
  "measurement_distance_m": 150.5,
  "defect_type": "–∫–æ—Ä—Ä–æ–∑–∏—è",
  "surface_location": "–í–ù–®"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "severity": "–∫—Ä–∏—Ç–∏—á–Ω—ã–π",
  "probability": 0.85,
  "probabilities": {
    "–∫—Ä–∏—Ç–∏—á–Ω—ã–π": 0.85,
    "–≤—ã—Å–æ–∫–∏–π": 0.10,
    "—Å—Ä–µ–¥–Ω–∏–π": 0.04,
    "–Ω–∏–∑–∫–∏–π": 0.01
  },
  "model_type": "XGBoost",
  "prediction_timestamp": "2025-12-07T10:30:45.123456"
}
```

#### GET /ml/model/info
–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π ML –º–æ–¥–µ–ª–∏.

#### GET /ml/model/metrics
–ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏.

**–û—Ç–≤–µ—Ç:**
```json
{
  "accuracy": 0.92,
  "precision": 0.89,
  "recall": 0.91,
  "f1_score": 0.90,
  "classification_report": "..."
}
```

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

#### GET /export/json
–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–µ—Ñ–µ–∫—Ç—ã –≤ JSON —Ñ–∞–π–ª.

–°–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª `defects_export.json` —Å–æ –≤—Å–µ–º–∏ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏.

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

–í—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω —Å —Ä–æ–ª—å—é admin.

#### POST /admin/defects
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –¥–µ—Ñ–µ–∫—Ç –≤—Ä—É—á–Ω—É—é.

**–¢—Ä–µ–±—É–µ—Ç:** Authorization Bearer —Ç–æ–∫–µ–Ω (admin)

#### PUT /admin/defects/{defect_id}
–û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–µ—Ñ–µ–∫—Ç.

**–¢—Ä–µ–±—É–µ—Ç:** Authorization Bearer —Ç–æ–∫–µ–Ω (admin)

#### DELETE /admin/defects/{defect_id}
–£–¥–∞–ª–∏—Ç—å –¥–µ—Ñ–µ–∫—Ç.

**–¢—Ä–µ–±—É–µ—Ç:** Authorization Bearer —Ç–æ–∫–µ–Ω (admin)

#### POST /admin/defects/update-all-severities
–û–±–Ω–æ–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ ML –º–æ–¥–µ–ª—å.

**–¢—Ä–µ–±—É–µ—Ç:** Authorization Bearer —Ç–æ–∫–µ–Ω (admin)

#### POST /reload
–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV —Ñ–∞–π–ª–æ–≤.

**–¢—Ä–µ–±—É–µ—Ç:** Authorization Bearer —Ç–æ–∫–µ–Ω (admin)

#### DELETE /clear
–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–µ—Ñ–µ–∫—Ç—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

**–¢—Ä–µ–±—É–µ—Ç:** Authorization Bearer —Ç–æ–∫–µ–Ω (admin)

## –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ ML –º–æ–¥–µ–ª–∏

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1. –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ CSV —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –¥–µ—Ñ–µ–∫—Ç–∞—Ö –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `data/`:
   - –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª: `data/Svodny_Otchet_ILI_Clean.csv`
   - –ò–ª–∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç–µ CSV —Ñ–∞–π–ª—ã –≤ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö `data/`

2. –§–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:
   - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: —à–∏—Ä–æ—Ç–∞, –¥–æ–ª–≥–æ—Ç–∞, –≤—ã—Å–æ—Ç–∞
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ—Ñ–µ–∫—Ç–∞: –≥–ª—É–±–∏–Ω–∞ (%), –¥–ª–∏–Ω–∞ (–º–º), —à–∏—Ä–∏–Ω–∞ (–º–º), —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–º–º)
   - –¢–∏–ø –¥–µ—Ñ–µ–∫—Ç–∞: –∫–æ—Ä—Ä–æ–∑–∏—è, —Å–≤–∞—Ä–Ω–æ–π —à–æ–≤, –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π –æ–±—ä–µ–∫—Ç
   - –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –í–ù–®/–í–ù–¢
   - –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å: –∫—Ä–∏—Ç–∏—á–Ω—ã–π, –≤—ã—Å–æ–∫–∏–π, —Å—Ä–µ–¥–Ω–∏–π, –Ω–∏–∑–∫–∏–π
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: ERF B31G, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Å–≤–∞—Ä–Ω–æ–≥–æ —à–≤–∞

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```bash
python train_model.py
```
### –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ
csv —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ data/
–∏ –¥–æ–ª–∂–µ–Ω –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è Svodny_Otchet_ILI_Clean.csv

–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:
CSV —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏ —Å:

–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (—à–∏—Ä–æ—Ç–∞, –¥–æ–ª–≥–æ—Ç–∞, –≤—ã—Å–æ—Ç–∞)
–ü–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –¥–µ—Ñ–µ–∫—Ç–∞ (–≥–ª—É–±–∏–Ω–∞ %, –¥–ª–∏–Ω–∞ –º–º, —à–∏—Ä–∏–Ω–∞ –º–º, —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ –º–º)
–¢–∏–ø–æ–º –¥–µ—Ñ–µ–∫—Ç–∞ (–∫–æ—Ä—Ä–æ–∑–∏—è, —Å–≤–∞—Ä–Ω–æ–π —à–æ–≤, –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π –æ–±—ä–µ–∫—Ç)
–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º (–í–ù–®/–í–ù–¢)
–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å—é (–∫—Ä–∏—Ç–∏—á–Ω—ã–π, –≤—ã—Å–æ–∫–∏–π, —Å—Ä–µ–¥–Ω–∏–π, –Ω–∏–∑–∫–∏–π) - —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
ERF B31G –∫–æ–¥, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Å–≤–∞—Ä–Ω–æ–≥–æ —à–≤–∞
–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π (;)

(–ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –≤ data/Svodny_Otchet_ILI_Clean.csv –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π)

### –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ó–∞–≥—Ä—É–∑–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV —Ñ–∞–π–ª–æ–≤
2. –í—ã–ø–æ–ª–Ω–∏—Ç –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –æ—á–∏—Å—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö
3. –°–æ–∑–¥–∞—Å—Ç –∏ –æ–±—É—á–∏—Ç XGBoost –º–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç –º–æ–¥–µ–ª—å –∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ `models/`:
   - `best_model.joblib` - –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
   - `scaler.joblib` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
   - `label_encoder.joblib` - –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ –º–µ—Ç–æ–∫
   - `onehot_encoder.joblib` - –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
   - `feature_names.joblib` - –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
   - `medians.joblib` - –º–µ–¥–∏–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤
   - `metrics.json` - –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏
5. –°–æ–∑–¥–∞—Å—Ç –≥—Ä–∞—Ñ–∏–∫ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: `models/feature_importance.png`

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏ –æ—Ç–æ–±—Ä–∞–∑—è—Ç—Å—è:
- –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (accuracy, precision, recall, F1-score)
- Confusion matrix
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ API:
```bash
python main.py
```

–ù–æ–≤–∞—è –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏

–°–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–∏—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –≤ MongoDB –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `admin_users`.

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
python manage_admins.py create <username> <password>
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
python manage_admins.py create john SecurePassword123
```

**–í—ã–≤–æ–¥:**
```
======================================================================
CREATING ADMIN USER IN DATABASE
======================================================================

Connecting to database...
Admin user created successfully!

Username: john
Password: SecurePassword123
Role: admin

You can now login at: POST /auth/login
======================================================================
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

```bash
python manage_admins.py list
```

**–í—ã–≤–æ–¥:**
```
======================================================================
ADMIN USERS LIST
======================================================================

1. admin (role: admin, active: True)
2. john (role: admin, active: True)

======================================================================
```

### –£–¥–∞–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
python manage_admins.py delete <username>
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
python manage_admins.py delete john
```

**–í—ã–≤–æ–¥:**
```
======================================================================
DELETING ADMIN USER: john
======================================================================

Admin user 'john' deleted successfully!
======================================================================
```

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:
- Username: `admin`
- Password: `admin`

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è:
1. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `python manage_admins.py delete <username>`
2. –°–æ–∑–¥–∞–π—Ç–µ —Å –Ω–æ–≤—ã–º –ø–∞—Ä–æ–ª–µ–º: `python manage_admins.py create <username> <new_password>`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
terricon/
‚îú‚îÄ‚îÄ main.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt         # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ train_model.py          # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è ML –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ manage_admins.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ .env                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.py           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ data/                   # CSV –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ models/                 # –û–±—É—á–µ–Ω–Ω—ã–µ ML –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ output/                 # –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îî‚îÄ‚îÄ src/
    ‚îú‚îÄ‚îÄ app.py              # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    ‚îú‚îÄ‚îÄ database.py         # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
    ‚îú‚îÄ‚îÄ api/                # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
    ‚îÇ   ‚îú‚îÄ‚îÄ auth_routes.py  # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    ‚îÇ   ‚îú‚îÄ‚îÄ defects.py      # CRUD –¥–µ—Ñ–µ–∫—Ç–æ–≤
    ‚îÇ   ‚îú‚îÄ‚îÄ ml_routes.py    # ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    ‚îÇ   ‚îú‚îÄ‚îÄ analytics.py    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    ‚îÇ   ‚îú‚îÄ‚îÄ export.py       # –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
    ‚îÇ   ‚îî‚îÄ‚îÄ admin.py        # –ê–¥–º–∏–Ω —Ñ—É–Ω–∫—Ü–∏–∏
    ‚îú‚îÄ‚îÄ auth/               # JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ core/               # –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –ë–î
    ‚îú‚îÄ‚îÄ ml/                 # ML –º–æ–¥—É–ª—å
    ‚îÇ   ‚îú‚îÄ‚îÄ train.py        # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
    ‚îÇ   ‚îú‚îÄ‚îÄ inference.py    # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
    ‚îÇ   ‚îî‚îÄ‚îÄ features.py     # Feature engineering
    ‚îî‚îÄ‚îÄ parsers/            # –ü–∞—Ä—Å–µ—Ä—ã CSV
```

## Troubleshooting

### MongoDB –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å MONGODB_URI –≤ `.env` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å mongodb+srv:// –¥–ª—è MongoDB Atlas)
2. Whitelist –≤–∞—à–µ–≥–æ IP –∞–¥—Ä–µ—Å–∞ –≤ MongoDB Atlas Network Access
3. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—è
4. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### ML –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞: `python train_model.py`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ `models/`:
   - `best_model.joblib`
   - `scaler.joblib`
   - `label_encoder.joblib`

### –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ `data/`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ CSV —Ñ–∞–π–ª—ã –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `logs/`

### –ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –∫–∞–∫ admin

1. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: username=`admin`, password=`admin`
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∞: `python manage_admins.py create test test123`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫: `python manage_admins.py list`

